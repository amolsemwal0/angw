<!-- CONDITIONAL RENDER: BOOT SEQUENCE vs MAIN APP -->
@if (!service.booted()) {
<app-boot-sequence></app-boot-sequence>
} @else {
<div
  class="min-h-screen bg-black text-slate-200 font-sans overflow-x-hidden flex flex-col md:flex-row relative animate-fadeIn"
>
  <!-- CRT Effects -->
  <div *ngIf="crtMode()" class="fixed inset-0 pointer-events-none z-[9999] overflow-hidden">
    <div
      class="absolute inset-0 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_4px,3px_100%] pointer-events-none"
    ></div>
    <div
      class="absolute inset-0 bg-white/5 opacity-[0.02] animate-flicker pointer-events-none"
    ></div>
    <div
      class="absolute inset-0 bg-[radial-gradient(circle_at_center,transparent_50%,rgba(0,0,0,0.4)_100%)] pointer-events-none"
    ></div>
  </div>

  <!-- Mobile Toggle -->
  <div
    class="md:hidden p-4 bg-slate-950 border-b border-slate-800 flex justify-between items-center z-50 relative"
  >
    <span class="font-mono text-emerald-400 font-bold">./root</span>
    <button (click)="service.toggleMobileMenu()" class="text-slate-400">
      <span class="text-2xl">â˜°</span>
    </button>
  </div>

  <!-- Sidebar -->
  <aside
    [class.hidden]="!mobileMenuOpen()"
    class="md:flex flex-col w-full md:w-64 bg-slate-950 border-r border-slate-900 h-auto md:h-screen fixed md:sticky top-0 z-40 transition-all"
  >
    <div class="p-6 border-b border-slate-900">
      <div
        class="w-16 h-16 rounded-full bg-gradient-to-br from-emerald-600 to-purple-700 p-0.5 mb-4"
      >
        <div
          class="w-full h-full bg-slate-950 rounded-full flex items-center justify-center font-bold text-xl"
        >
          DEV
        </div>
      </div>
      <h1 class="font-bold text-white tracking-wider">AMOL SEMWAL</h1>
      <div class="flex items-center gap-2 mt-2">
        <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span
        ><span class="text-xs font-mono text-emerald-500">SYSTEM ONLINE</span>
      </div>
    </div>

    <nav class="flex-1 p-4 space-y-1">
      @for(tab of tabs; track tab.id) {
      <button
        (click)="service.setActiveTab(tab.id)"
        [class.bg-emerald-500-10]="activeTab() === tab.id"
        [class.text-emerald-400]="activeTab() === tab.id"
        class="w-full text-left px-4 py-3 rounded hover:bg-slate-900 hover:text-white transition-colors font-mono text-sm flex items-center group"
      >
        <span
          class="w-1 h-full bg-emerald-500 absolute left-0 opacity-0 transition-opacity"
          [class.opacity-100]="activeTab() === tab.id"
        ></span>
        <span class="opacity-50 mr-3 group-hover:text-emerald-500">#</span
        >{{ tab.label | uppercase }}
      </button>
      }
    </nav>

    <div class="p-4 border-t border-slate-900">
      <button
        (click)="service.toggleCrt()"
        class="w-full py-2 border border-slate-800 rounded text-xs font-mono text-slate-500 hover:text-emerald-400 hover:border-emerald-500 transition-colors"
      >
        TOGGLE CRT: {{ crtMode() ? 'ON' : 'OFF' }}
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 min-h-screen relative bg-[#0a0a0a]">
    <div
      class="absolute inset-0 bg-[linear-gradient(to_right,#1f2937_1px,transparent_1px),linear-gradient(to_bottom,#1f2937_1px,transparent_1px)] bg-[size:40px_40px] opacity-[0.15] pointer-events-none perspective-grid"
    ></div>
    <div class="relative p-6 md:p-10 max-w-5xl mx-auto pb-20">
      <app-dashboard></app-dashboard>
    </div>
  </main>
</div>
}